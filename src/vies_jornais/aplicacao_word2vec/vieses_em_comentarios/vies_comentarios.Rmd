---
title: "vies_comentarios"
author: "Allan Sales"
date: "21 de dezembro de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("../2017-Caliskan-WEAT/weat.R")
library(wordVectors)
```

```{r}
estadao_up = read.binary.vectors("../word_embeddings/vieses_em_comentarios/embeddings/estadao_thumbs_up.bin")
folha_up = read.binary.vectors("../word_embeddings/vieses_em_comentarios/embeddings/folha_thumbs_up.bin")
folha_down = read.binary.vectors("../word_embeddings/vieses_em_comentarios/embeddings/folha_thumbs_down.bin")
folha_up_down = read.binary.vectors("../word_embeddings/vieses_em_comentarios/embeddings/folha_thumbs_up_down.bin")
```

## Verifica se todas as palavras estao contidas no vocabulario dos portais
```{r}
portal_contem_palavras <- function(x, y, a, b, modelo){
  targets = data_frame(X = x, Y = y)
  features = data_frame(A = a, B = b)

  contem = modelo_contem_palavra(features, targets, modelo)
  print(contem)
  return(contem)
}

calcula_scores_portais <- function(x, y, a, b, modelo){
  permutacoes = permutacao(x, y)
  score_Xi_Yi = score_permutacoes(permutacoes$Xi, permutacoes$Yi, a, b, modelo)

  scores = bind_cols(permutacoes$Xi, permutacoes$Yi, score = score_Xi_Yi)
  return(scores)
}

execute <- function(x, y, a, b, modelo){
  scores = calcula_scores_portais(x, y, a, b, modelo) %>% arrange(-score)

  score_X_Y = score_targets(x, y, a, b, modelo)
  p_valor = pvalor(scores$score, score_X_Y)
  tam_efeito = effect_size(x, y, a, b, modelo)

  valores = data_frame(p_valor, tam_efeito)
  
  return(list(valores = valores, scores_permutacao = scores, score_X_Y = score_X_Y))
}

checa_vies <- function(x, y, a, b, modelo){
  contem = portal_contem_palavras(x, y, a, b, modelo)
  if(contem){
    candidatos_prazer = execute(x, y, a, b, modelo)
    return(candidatos_prazer)  
  }
}

```

## Conjuntos de palavras

### Prazer
#### candidatos presidência x prazer
```{r}
x = c("aécio", "neves", "fhc", "psdb", "aloysio")
y = c("dilma", "rousseff", "lula", "pt", "temer")
a = c("carinho", "liberdade", "saúde", "amor", "paz", "alegria", "fiel", "honesto", "sorte", "diploma", "presente", "honra", "família", "feliz", "férias")
b = c("abuso", "quebra", "doença", "acidente", "sofrimento", "assalto", "desastre", "ódio", "tragédia", "cadeia", "pobreza", "feio", "câncer", "morte", "prisão")

vies_estadao_up_cand_prazer = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_cand_prazer = checa_vies(x, y, a, b, folha_up)
vies_folha_down_cand_prazer = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_cand_prazer = checa_vies(x, y, a, b, folha_up_down)
```

#### partidos x prazer
```{r}
x = c("dilma", "lula", "pt", "padilha", "haddad")
y = c("aÃ©cio", "fhc", "psdb", "alckmin", "dÃ³ria")
a = c("carinho", "liberdade", "saÃºde", "amor", "paz", "alegria", "fiel", "honesto", "sorte", "diploma", "presente", "honra", "famÃ­lia", "feliz", "fÃ©rias")
b = c("abuso", "quebra", "doenÃ§a", "acidente", "sofrimento", "assalto", "desastre", "Ã³dio", "tragÃ©dia", "cadeia", "pobreza", "feio", "cÃ¢ncer", "morte", "prisÃ£o")

vies_estadao_up_part_prazer = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_part_prazer = checa_vies(x, y, a, b, folha_up)
vies_folha_down_part_prazer = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_part_prazer = checa_vies(x, y, a, b, folha_up_down)
```

### presidentes vs prefeitos/governadores x prazer
```{r}
x = c("dilma", "lula", "fhc", "aÃ©cio")
y = c("haddad", "alckmin", "dÃ³ria", "padilha")
a = c("carinho", "liberdade", "saÃºde", "amor", "paz", "alegria", "fiel", "honesto", "sorte", "diploma", "presente", "honra", "famÃ­lia", "feliz", "fÃ©rias")
b = c("abuso", "quebra", "doenÃ§a", "acidente", "sofrimento", "assalto", "desastre", "Ã³dio", "tragÃ©dia", "cadeia", "pobreza", "feio", "cÃ¢ncer", "morte", "prisÃ£o")

vies_estadao_up_pref_presi_prazer = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_pref_presi_prazer = checa_vies(x, y, a, b, folha_up)
vies_folha_down_pref_presi_prazer = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_pref_presi_prazer = checa_vies(x, y, a, b, folha_up_down)
```

### Tempo
#### candidatos presidÃªncia x tempo
```{r}
x = c("dilma", "rousseff", "lula", "pt", "temer")
y = c("aÃ©cio", "neves", "fhc", "psdb", "aloysio")
a = c("sempre", "longo", "constante", "eterno", "permanente")
b = c("curto", "breve", "passagem", "provisÃ³rio", "mortal")

vies_estadao_up_cand_tempo = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_cand_tempo = checa_vies(x, y, a, b, folha_up)
vies_folha_down_cand_tempo = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_cand_tempo = checa_vies(x, y, a, b, folha_up_down)
```

#### partidos PT/PSDB x tempo
```{r}
x = c("dilma", "lula", "pt", "padilha", "haddad")
y = c("aÃ©cio", "fhc", "psdb", "alckmin", "dÃ³ria")
a = c("sempre", "longo", "constante", "eterno", "permanente")
b = c("curto", "breve", "passagem", "provisÃ³rio", "mortal")

vies_estadao_up_pt_psdb_tempo = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_pt_psdb_tempo = checa_vies(x, y, a, b, folha_up)
vies_folha_down_pt_psdb_tempo = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_pt_psdb_tempo = checa_vies(x, y, a, b, folha_up_down)
```

### Genero
#### Genero x orientacao 1
```{r}
x = c("dilma", "genro", "marina", "marta", "erundina", "rosÃ¡rio")
y = c("aÃ©cio", "lula", "fhc", "cunha", "temer", "bolsonaro")
a = c("pt", "psb", "psd", "pdt", "pps", "pcdob", "psol")
b = c("pp", "pr", "prb", "pros", "phs", "pen", "dem")

#vies_estadao_up_genero_orientacao = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_genero_orientacao = checa_vies(x, y, a, b, folha_up)
vies_folha_down_genero_orientacao = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_genero_orientacao = checa_vies(x, y, a, b, folha_up_down)
```

#### Genero x orientacao 2
```{r}
# Usar ele, ela, homem, mulher, sinonimos
x = c("mulher", "mÃ£e", "tia", "avÃ³", "filha", "moÃ§a", "dona", "senhora")
y = c("homem", "pai", "tio", "avÃ´", "filho", "moÃ§o", "dono", "senhor")
a = c("pt", "psb", "psd", "pdt", "pps", "pcdob", "psol")
b = c("pp", "pr", "prb", "pros", "phs", "pen", "dem")

#vies_estadao_up_genero_orientacao = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_genero_orientacao = checa_vies(x, y, a, b, folha_up)
vies_folha_down_genero_orientacao = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_genero_orientacao = checa_vies(x, y, a, b, folha_up_down)
```

### Nivel economico
#### nivel economico x orientacao
```{r}
x = c("pobreza", "misÃ©ria", "indigÃªncia", "inÃ³pia", "humildade", "dificuldade", "subdesenvolvimento", "desgraÃ§a", "fome", "dureza")
y = c("riqueza", "recursos", "capital", "patrimÃ´nio", "fortuna", "dinheiro", "ouro", "posses", "heranÃ§a", "bens")
a = c("pt", "psb", "psd", "pdt", "pps", "pcdob", "psol")
b = c("pp", "pr", "prb", "pros", "phs", "pen", "dem")

#vies_estadao_up_genero_orientacao = checa_vies(x, y, a, b, estadao_up)
vies_folha_up_genero_orientacao = checa_vies(x, y, a, b, folha_up)
vies_folha_down_genero_orientacao = checa_vies(x, y, a, b, folha_down)
vies_folha_up_down_genero_orientacao = checa_vies(x, y, a, b, folha_up_down)
```

