a = ids %>% rowwise() %>% get_collection(comentarios_collection, query)
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = '{"idNoticia": "FOLHASP-1887139"}'
data <- con$find(query)
rm(con)
return(data)
}
a = ids %>% rowwise() %>% get_collection2(comentarios_collection)
View(a)
a = ids %>% rowwise() %>% summarise(get_collection2(comentarios_collection))
a = ids %>% rowwise() %>% get_collection2(comentarios_collection)
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = printf('{"idNoticia": %s}', id)
#query = '{"idNoticia": "FOLHASP-1887139"}'
data <- con$find(query)
rm(con)
return(data)
}
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = printf('{"idNoticia": %s}', id)
print(query)
#query = '{"idNoticia": "FOLHASP-1887139"}'
data <- con$find(query)
rm(con)
return(data)
}
ids = data_frame(idNoticia = c("FOLHASP-1887139","FOLHASP-1887182"))
a = ids %>% rowwise() %>% get_collection2(comentarios_collection)
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": %s}', id)
print(query)
#query = '{"idNoticia": "FOLHASP-1887139"}'
data <- con$find(query)
rm(con)
return(data)
}
a = ids %>% rowwise() %>% get_collection2(comentarios_collection)
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
print(id)
query = sprintf('{"idNoticia": %s}', id)
print(query)
#query = '{"idNoticia": "FOLHASP-1887139"}'
data <- con$find(query)
rm(con)
return(data)
}
a = ids %>% rowwise() %>% get_collection2(comentarios_collection)
a = ids %>% group_by(idNoticia) %>% rowwise() %>% get_collection2(comentarios_collection)
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": %s}', id)
print(query)
#query = '{"idNoticia": "FOLHASP-1887139"}'
data <- con$find(query)
rm(con)
return(data)
}
ids = data_frame(idNoticia = c("FOLHASP-1887139","FOLHASP-1887182"))
comentarios_collection = "folhaComentariosProcessados"
a = ids %>% group_by(idNoticia) %>% rowwise() %>% get_collection2(comentarios_collection)
get_collection2 <- function(id, colecao){
#con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": %s}', id)
print(query)
#query = '{"idNoticia": "FOLHASP-1887139"}'
#data <- con$find(query)
#rm(con)
#return(data)
}
ids = data_frame(idNoticia = c("FOLHASP-1887139","FOLHASP-1887182"))
ids
comentarios_collection = "folhaComentariosProcessados"
a = ids %>% group_by(idNoticia) %>% rowwise() %>% get_collection2(comentarios_collection)
get_collection2 <- function(id, colecao){
#con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
print(id)
query = sprintf('{"idNoticia": %s}', id)
print(query)
#query = '{"idNoticia": "FOLHASP-1887139"}'
#data <- con$find(query)
#rm(con)
#return(data)
}
ids = data_frame(idNoticia = c("FOLHASP-1887139","FOLHASP-1887182"))
comentarios_collection = "folhaComentariosProcessados"
a = ids %>% group_by(idNoticia) %>% rowwise() %>% get_collection2(comentarios_collection)
a = ids %>% group_by(idNoticia)  %>% get_collection2(comentarios_collection)
get_collection2 <- function(id, colecao){
#con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": %s}', id)
print(query)
#query = '{"idNoticia": "FOLHASP-1887139"}'
#data <- con$find(query)
#rm(con)
#return(data)
return(query)
}
a = ids %>% group_by(idNoticia) %>% summarise(get_collection2(queries = comentarios_collection))
a = ids %>% group_by(idNoticia) %>% summarise(queries = get_collection2(comentarios_collection))
a = ids %>% group_by(idNoticia) %>% summarise(queries = get_collection2(idNoticia, comentarios_collection))
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": %s}', id)
print(query)
data <- con$find(query)
rm(con)
return(data)
#return(query)
}
a = ids %>% group_by(idNoticia) %>% summarise(queries = get_collection2(idNoticia, comentarios_collection))
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
print(query)
data <- con$find(query)
rm(con)
return(data)
#return(query)
}
a = ids %>% group_by(idNoticia) %>% summarise(queries = get_collection2(idNoticia, comentarios_collection))
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
print(query)
data <- con$find(query)
rm(con)
return(list(data))
#return(query)
}
a = ids %>% group_by(idNoticia) %>% summarise(queries = get_collection2(idNoticia, comentarios_collection))
View(a)
a[[1]]
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
print(query)
data <- con$find(query)
print(nrow(data))
rm(con)
return(list(data))
#return(query)
}
a = ids %>% group_by(idNoticia) %>% summarise(queries = get_collection2(idNoticia, comentarios_collection))
View(a)
return(data_frame(data))
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
print(query)
data <- con$find(query)
print(nrow(data))
rm(con)
return(data_frame(data))
#return(query)
}
a = ids %>% group_by(idNoticia) %>% summarise(queries = get_collection2(idNoticia, comentarios_collection))
idNoticia = c("FOLHASP-1887139","FOLHASP-1887182")
get_collection2 <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
print(query)
data <- con$find(query)
print(nrow(data))
rm(con)
return(data)
#return(query)
}
b = lapply(idNoticia, get_collection2(comentarios_collection))
comentarios_collection = "folhaComentariosProcessados"
b = lapply(idNoticia, get_collection2(comentarios_collection))
comentarios_collection
b = lapply(idNoticia, get_collection2(x, comentarios_collection))
b = lapply(idNoticia, get_collection2(id, comentarios_collection))
id
b = lapply(idNoticia, get_collection2(x), comentarios_collection)
?lapply
b = lapply(idNoticia, get_collection2, comentarios_collection)
b
a = b[[1]]
c = b[[2]]
View(c)
View(a)
d = bind_rows(b)
View(d)
get_by_idNoticia <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
data <- con$find(query)
rm(con)
return(data)
}
ids = data_frame(idNoticia = c("FOLHASP-1887139","FOLHASP-1887182"))
comentarios_collection = "folhaComentariosProcessados"
idNoticia = c("FOLHASP-1887139","FOLHASP-1887182")
ids = data_frame(idNoticia = c("FOLHASP-1887139","FOLHASP-1887182"))
comentarios_collection = "folhaComentariosProcessados"
idNoticia = c("FOLHASP-1887139","FOLHASP-1887182")
a = lapply(idNoticia, get_by_idNoticia, comentarios_collection) %>% bind_rows()
View(a)
get_docs_by_idNoticia <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
data <- con$find(query)
rm(con)
return(data)
}
get_comentarios_por_data <- function(fonte, noticias, data_inicio, data_fim){
if(str_detect(fonte,"estadao")){
comentarios_collection = "estadaoComentariosProcessados"
} else if(str_detect(fonte,"folha")){
comentarios_collection = "folhaComentariosProcessados"
} else if(str_detect(fonte,"g1")){
comentarios_collection = "g1ComentariosProcessados"
}
#noticias = get_collection(fonte) %>% filter(timestamp >= data_inicio & timestamp <= data_fim)
idNoticias = noticias$idNoticia
comentarios = get_docs_by_idNoticia(id, comentarios_collection)
return(comentarios)
}
a = lapply(ids$idNoticia, get_by_idNoticia, comentarios_collection) %>% bind_rows()
get_comentarios_por_data <- function(fonte, noticias, data_inicio, data_fim){
if(str_detect(fonte,"estadao")){
comentarios_collection = "estadaoComentariosProcessados"
} else if(str_detect(fonte,"folha")){
comentarios_collection = "folhaComentariosProcessados"
} else if(str_detect(fonte,"g1")){
comentarios_collection = "g1ComentariosProcessados"
}
#noticias = get_collection(fonte) %>% filter(timestamp >= data_inicio & timestamp <= data_fim)
idNoticias = noticias %>% select(idNoticia)
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection) %>% bind_rows()
return(comentarios)
}
get_comentarios_de_set_noticias <- function(fonte, noticias){
if(str_detect(fonte,"estadao")){
comentarios_collection = "estadaoComentariosProcessados"
} else if(str_detect(fonte,"folha")){
comentarios_collection = "folhaComentariosProcessados"
} else if(str_detect(fonte,"g1")){
comentarios_collection = "g1ComentariosProcessados"
}
#noticias = get_collection(fonte) %>% filter(timestamp >= data_inicio & timestamp <= data_fim)
idNoticias = noticias %>% select(idNoticia)
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection) %>% bind_rows()
return(comentarios)
}
get_comentarios_de_set_noticias <- function(fonte, noticias){
if(str_detect(fonte,"estadao")){
comentarios_collection = "estadaoComentariosProcessados"
} else if(str_detect(fonte,"folha")){
comentarios_collection = "folhaComentariosProcessados"
} else if(str_detect(fonte,"g1")){
comentarios_collection = "g1ComentariosProcessados"
}
#noticias = get_collection(fonte) %>% filter(timestamp >= data_inicio & timestamp <= data_fim)
idNoticias = noticias %>% select(idNoticia)
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection) %>% bind_rows()
return(comentarios)
}
tema = "folha_noticias_eleicao_2014"
noticias_folha <- get_collection("folhaNoticiasProcessadas")
knitr::opts_chunk$set(echo = TRUE)
source("../utils/mongo_utils.R")
candidatos <- c("dilma","aécio","levy","marina silva","luciana genro","eduardo jorge","josé maria","pastor everaldo", "iasi","eymael","rui costa","eduardo campos")
entity <- c(candidatos, partidos)
pattern <- paste(entity, collapse = "|")
partidos <- c("pmdb","ptb","pdt","pt","dem ","psb","psdb","ptc","psc","pmn","prp","pps","pv","pp","pstu","pcb","prtb","phs","psdc","pco","ptn","psl","prb","psol","ppl","pros","psd |psd[.]"," sd |sd[.]") #,"pr","pen", "pcdob", "ptdob"
candidatos <- c("dilma","aécio","levy","marina silva","luciana genro","eduardo jorge","josé maria","pastor everaldo", "iasi","eymael","rui costa","eduardo campos")
entity <- c(candidatos, partidos)
pattern <- paste(entity, collapse = "|")
data_inicio = "2014-01-01"
data_fim = "2014-12-31"
noticias_folha_tema <- noticias_folha %>% filter(timestamp >= data_inicio & timestamp <= data_fim) %>% noticias_tema(pattern, "titulo")
noticias_tema <- function(data, pattern, secao){
true_false_vector <- data %>% select(secao) %>%
unlist() %>% as.vector() %>%
tolower() %>% str_detect(pattern)
noticias <- data %>% filter(true_false_vector == TRUE)
return(noticias)
}
noticias_folha_tema <- noticias_folha %>% filter(timestamp >= data_inicio & timestamp <= data_fim) %>% noticias_tema(pattern, "titulo")
a = get_comentarios_de_set_noticias("folha", noticias_folha_tema)
View(noticias_folha_tema)
comentarios_collection = "folha"
noticias = noticias_folha_tema
if(str_detect(fonte,"estadao")){
comentarios_collection = "estadaoComentariosProcessados"
} else if(str_detect(fonte,"folha")){
comentarios_collection = "folhaComentariosProcessados"
} else if(str_detect(fonte,"g1")){
comentarios_collection = "g1ComentariosProcessados"
}
fonte = "folha"
noticias = noticias_folha_tema
if(str_detect(fonte,"estadao")){
comentarios_collection = "estadaoComentariosProcessados"
} else if(str_detect(fonte,"folha")){
comentarios_collection = "folhaComentariosProcessados"
} else if(str_detect(fonte,"g1")){
comentarios_collection = "g1ComentariosProcessados"
}
comentarios_collection
idNoticias = noticias %>% select(idNoticia)
idNoticias
idNoticias = noticias %>% select(idNoticia) %>% slice(1:10)
idNoticias
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection)
get_docs_by_idNoticia <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": "%s"}', id)
data <- con$find(query)
print(data)
rm(con)
return(data)
}
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection)
get_docs_by_idNoticia <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
print(id)
query = sprintf('{"idNoticia": "%s"}', id)
data <- con$find(query)
rm(con)
return(data)
}
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection)
get_docs_by_idNoticia <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
print(id)
query = sprintf('{"idNoticia": "%s"}', id)
print(query)
data <- con$find(query)
rm(con)
return(data)
}
lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection)
idNoticias = c("FOLHASP-1887139","FOLHASP-1887182")
lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection)
idNoticias = noticias %>% select(idNoticia) %>% slice(1:10)
idNoticias
idNoticias = c("FOLHASP-1569090","FOLHASP-1568974")
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection) %>% bind_rows()
idNoticias = noticias %>% select(idNoticia) %>% slice(1:10) %>% as.vector()
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection) %>% bind_rows()
idNoticias
idNoticias = noticias$idNoticia
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection) %>% bind_rows()
idNoticias = noticias$idNoticia[1:10]
comentarios = lapply(idNoticias, get_docs_by_idNoticia, comentarios_collection) %>% bind_rows()
View(comentarios)
get_docs_by_idNoticia <- function(id, colecao, con){
print(id)
query = sprintf('{"idNoticia": "%s"}', id)
print(query)
data <- con$find(query)
return(data)
}
get_docs_by_idNoticia <- function(id, colecao){
con <- mongo(db = "stocks", collection = colecao, url = "mongodb://localhost", verbose = FALSE, options = ssl_options())
query = sprintf('{"idNoticia": {"$in": "%s"} }', id)
data <- con$find(query)
rm(con)
return(data)
}
comentarios_collection
ids
a = get_docs_by_idNoticia(id = ids, colecao = comentarios_collection)
install.packages("rmongodb")
install.packages("aearefafafaefea")
install_github("mongosoup/rmongodb")
mongo <- mongoDbConnect("test")
install.packages("RMongo")
library(RMongo)
mongo <- mongoDbConnect("test")
output <- dbInsertDocument(mongo, "test_data", '{"foo": "bar"}')
output
output <- dbInsertDocument(mongo, "test_data", '{"foo": "bar2"}, {"foo":"bar3"}')
output <- dbGetQuery(mongo, 'test_data', '{"foo": "bar2"}')
output
View(output)
output <- dbGetQuery(mongo, 'test_data', '{"foo": ["bar2","bar"]}')
View(output)
output <- dbGetQuery(mongo, 'test_data', '{"foo": {"bar2","bar"}')
output <- dbGetQuery(mongo, 'test_data', '{"foo": {["bar2","bar"]}')
output <- dbGetQuery(mongo, 'test_data', '{"foo": { "$regex": "bar*", "$options": "i"} }')
View(output)
output <- dbGetQuery(mongo, 'test_data', '{"foo": { "$in": {"bar","bar2}} }')
output <- dbGetQuery(mongo, 'test_data', '{"foo": { "$in": {"bar","bar2"}, "$options": "i"} }')
output <- dbGetQuery(mongo, 'test_data', '{"foo": { "$in": {"bar","bar2"}} }')
output <- dbGetQuery(mongo, 'test_data', '{"foo": { "$in": ["bar","bar2"]} }')
View(output)
output <- dbGetQuery(mongo, 'folhaComentariosProcessados', '{"idNoticia": { "$in": ["FOLHASP-1887139","FOLHASP-1887182"]} }')
output <- dbGetQuery(mongo, 'folhaComentariosProcessados', '{"idNoticia": { "$in": ["FOLHASP-1887139"]} }')
mongo <- mongoDbConnect("stocks")
output <- dbGetQuery(mongo, 'folhaComentariosProcessados', '{"idNoticia": { "$in": ["FOLHASP-1887139","FOLHASP-1887182"]} }')
View(output)
ids = data_frame(idNoticia = c("FOLHASP-1887139","FOLHASP-1887182"))
query = sprintf('{"idNoticia": { "$in": [%s]} }', ids$idNoticia)
query
idNOticias = collapse(ids$idNoticia, sep=",")
idNoticias = paste(ids$idNoticia, collapse = ",")
idNoticias
idNoticias = paste(ids$idNoticia, collapse = "\",\"")
idNoticias
idNoticias = paste(ids$idNoticia, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": [%s]} }', )
query = sprintf('{"idNoticia": { "$in": [%s]} }', idNoticias)
query
output <- dbGetQuery(mongo, 'folhaComentariosProcessados', query)
idNoticias = paste(ids$idNoticia, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output <- dbGetQuery(mongo, 'folhaComentariosProcessados', query)
output
mongo = mongoDbConnect("stocks")
get_docs_by_idNoticia <- function(vetor_ids, colecao){
mongo = mongoDbConnect("stocks")
idNoticias = paste(vetor_ids, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output = dbGetQuery(mongo, colecao, query)
rm(mongo)
return(output)
}
knitr::opts_chunk$set(echo = TRUE)
source("../utils/mongo_utils.R")
source("../utils/utils.R")
source("../utils/embeddings_utils.R")
source("cria_word_embedding.R")
library("wordVectors")
library("readr")
noticias <- get_todas_noticias_processadas()
partidos <- c("pmdb","ptb","pdt","pt","dem ","psb","psdb","ptc","psc","pmn","prp","pps","pv","pp","pstu","pcb","prtb","phs","psdc","pco","ptn","psl","prb","psol","ppl","pros","psd |psd[.]"," sd |sd[.]") #,"pr","pen", "pcdob", "ptdob"
candidatos <- c("dilma","aécio","levy","marina silva","luciana genro","eduardo jorge","josé maria","pastor everaldo", "iasi","eymael","rui costa","eduardo campos")
entity <- c(candidatos, partidos)
pattern <- paste(entity, collapse = "|")
# limiar de 1 porque eh o cossendo de pi/3 (que implica da distancia entre as palavras serem menores entre si que entre elas e a origem)
limiar = 1.1
MIN_TAMANHO = 3
n_layers = 300
referencia_1 = "dilma"
referencia_2 = "aécio"
data_inicio = "2014-01-01"
data_fim = "2014-12-31"
analogias <- c("pt psdb dilma", "pt pv dilma","pt prtb dilma","pt psol dilma","pt psb dilma","pt psdc dilma","psdb pv aécio","psdb prtb aécio","psdb psol aécio","psdb psb aécio","psdb psdc aécio","pv prtb jorge","pv psol jorge","pv psb jorge","pv psdc jorge","prtb psol fidelix","prtb psb fidelix","prtb psdc fidelix","psol psb luciana","psol psdc luciana","psb psdc marina","dilma aécio rousseff","campos psb aécio","pt psdb petista")
respostas <- c("aécio","jorge","fidelix","luciana","marina","eymael","jorge","fidelix","luciana","marina","eymael","fidelix","luciana","marina","eymael","luciana","marina","eymael","marina","eymael","eymael","neves","psdb","tucano")
tema = "folha_noticias_eleicao_2014"
noticias_folha <- noticias %>% filter(subFonte == "FOLHASP")
noticias_folha_tema <- noticias_folha %>% filter(timestamp >= data_inicio & timestamp <= data_fim) %>% noticias_tema(pattern, "titulo")
tema = "folha_comentarios_eleicao_2014"
noticias_folha_tema$idNoticia
comentarios_folha_tema <- get_docs_by_idNoticia(colecao = "folhaComentariosProcessados", vetor_ids = noticias_folha_tema$idNoticia)
View(comentarios_folha_tema)
?dbGetQuery
.Machine$integer.max
get_docs_by_idNoticia <- function(vetor_ids, colecao){
mongo = mongoDbConnect("stocks")
idNoticias = paste(vetor_ids, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output = dbGetQuery(mongo, colecao, query, limit = .Machine$integer.max)
rm(mongo)
return(output)
}
comentarios_folha_tema <- get_docs_by_idNoticia(colecao = "folhaComentariosProcessados", vetor_ids = noticias_folha_tema$idNoticia)
get_docs_by_idNoticia <- function(vetor_ids, colecao){
mongo = mongoDbConnect("stocks")
idNoticias = paste(vetor_ids, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output = dbGetQuery(mongo, colecao, query, limit = (.Machine$integer.max))
rm(mongo)
return(output)
}
comentarios_folha_tema <- get_docs_by_idNoticia(colecao = "folhaComentariosProcessados", vetor_ids = noticias_folha_tema$idNoticia)
get_docs_by_idNoticia <- function(vetor_ids, colecao){
mongo = mongoDbConnect("stocks")
idNoticias = paste(vetor_ids, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output = dbGetQuery(mongo, colecao, query)
rm(mongo)
return(output)
}
comentarios_folha_tema <- get_docs_by_idNoticia(colecao = "folhaComentariosProcessados", vetor_ids = noticias_folha_tema$idNoticia)
get_docs_by_idNoticia <- function(vetor_ids, colecao){
mongo = mongoDbConnect("stocks")
idNoticias = paste(vetor_ids, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output = dbGetQuery(mongo, colecao, query, limit = 3000)
rm(mongo)
return(output)
}
comentarios_folha_tema <- get_docs_by_idNoticia(colecao = "folhaComentariosProcessados", vetor_ids = noticias_folha_tema$idNoticia)
get_docs_by_idNoticia <- function(vetor_ids, colecao){
mongo = mongoDbConnect("stocks")
idNoticias = paste(vetor_ids, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output = dbGetQuery(mongo, colecao, query, limit = 1000)
rm(mongo)
return(output)
}
comentarios_folha_tema <- get_docs_by_idNoticia(colecao = "folhaComentariosProcessados", vetor_ids = noticias_folha_tema$idNoticia)
get_docs_by_idNoticia <- function(vetor_ids, colecao){
mongo = mongoDbConnect("stocks")
idNoticias = paste(vetor_ids, collapse = "\",\"")
query = sprintf('{"idNoticia": { "$in": ["%s"]} }', idNoticias)
output = dbGetQuery(mongo, colecao, query, skip=0, limit=Inf)
rm(mongo)
return(output)
}
comentarios_folha_tema <- get_docs_by_idNoticia(colecao = "folhaComentariosProcessados", vetor_ids = noticias_folha_tema$idNoticia)
View(comentarios_folha_tema)
